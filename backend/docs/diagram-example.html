<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›¾è¡¨æ¸²æŸ“ç¤ºä¾‹</title>

  <!-- Mermaid.js -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <!-- Prism.js for code highlighting -->
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
      padding: 2rem;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: #2563eb;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #e5e7eb;
    }

    h2 {
      color: #1e40af;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }

    p {
      margin-bottom: 1rem;
    }

    /* å›¾è¡¨å®¹å™¨æ ·å¼ */
    .diagram-container {
      margin: 2rem 0;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
      background: #f9fafb;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    /* å›¾è¡¨æ¸²æŸ“åŒºåŸŸ */
    .diagram-render {
      padding: 2rem;
      background: white;
      overflow-x: auto;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Mermaid å›¾è¡¨æ ·å¼ */
    .diagram-render.mermaid svg {
      max-width: 100%;
      height: auto;
    }

    /* æºç æŠ˜å åŒºåŸŸ */
    .diagram-source {
      border-top: 1px solid #e5e7eb;
      background: #f3f4f6;
    }

    .diagram-source summary {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      user-select: none;
      font-size: 0.875rem;
      color: #6b7280;
      font-weight: 500;
      transition: all 0.2s;
      list-style: none;
    }

    .diagram-source summary::-webkit-details-marker {
      display: none;
    }

    .diagram-source summary::before {
      content: 'â–¶ ';
      display: inline-block;
      margin-right: 0.5rem;
      transition: transform 0.2s;
    }

    .diagram-source[open] summary::before {
      transform: rotate(90deg);
    }

    .diagram-source summary:hover {
      background: #e5e7eb;
      color: #374151;
    }

    .diagram-source pre {
      margin: 0;
      padding: 1.5rem;
      background: #1e293b;
      overflow-x: auto;
    }

    .diagram-source code {
      color: #e2e8f0;
      font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
      font-size: 0.875rem;
      line-height: 1.7;
    }

    /* ç±»å‹æ ‡ç­¾ */
    .diagram-type-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      background: #dbeafe;
      color: #1e40af;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 1rem;
    }

    /* åŠ è½½çŠ¶æ€ */
    .diagram-loading {
      text-align: center;
      color: #6b7280;
      padding: 2rem;
    }

    /* é”™è¯¯æç¤º */
    .diagram-error {
      padding: 1rem 1.5rem;
      color: #dc2626;
      background: #fee2e2;
      border-radius: 4px;
      font-size: 0.875rem;
      border-left: 4px solid #dc2626;
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }

      .container {
        padding: 1rem;
      }

      .diagram-render {
        padding: 1rem;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ“Š å›¾è¡¨æ¸²æŸ“ç¤ºä¾‹</h1>
    <p>è¿™æ˜¯åç«¯ <code>PostProcessor</code> å¤„ç†åçš„ HTML è¾“å‡ºç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨å‰ç«¯æ¸²æŸ“å„ç§å›¾è¡¨ã€‚</p>

    <h2>1. æµç¨‹å›¾ï¼ˆFlowchartï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        graph TD
        A[å¼€å§‹] --> B{æ˜¯å¦ç™»å½•?}
        B -->|æ˜¯| C[æ˜¾ç¤ºä¸»é¡µ]
        B -->|å¦| D[è·³è½¬ç™»å½•é¡µ]
        C --> E[åŠ è½½æ•°æ®]
        E --> F[æ¸²æŸ“é¡µé¢]
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">graph TD
    A[å¼€å§‹] --> B{æ˜¯å¦ç™»å½•?}
    B -->|æ˜¯| C[æ˜¾ç¤ºä¸»é¡µ]
    B -->|å¦| D[è·³è½¬ç™»å½•é¡µ]
    C --> E[åŠ è½½æ•°æ®]
    E --> F[æ¸²æŸ“é¡µé¢]</code></pre>
      </details>
    </div>

    <h2>2. æ—¶åºå›¾ï¼ˆSequence Diagramï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        sequenceDiagram
        participant ç”¨æˆ·
        participant å‰ç«¯
        participant åç«¯
        participant æ•°æ®åº“

        ç”¨æˆ·->>å‰ç«¯: æäº¤è¡¨å•
        å‰ç«¯->>åç«¯: POST /api/posts
        åç«¯->>æ•°æ®åº“: INSERT INTO posts
        æ•°æ®åº“-->>åç«¯: è¿”å› ID
        åç«¯-->>å‰ç«¯: 201 Created
        å‰ç«¯-->>ç”¨æˆ·: æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">sequenceDiagram
    participant ç”¨æˆ·
    participant å‰ç«¯
    participant åç«¯
    participant æ•°æ®åº“

    ç”¨æˆ·->>å‰ç«¯: æäº¤è¡¨å•
    å‰ç«¯->>åç«¯: POST /api/posts
    åç«¯->>æ•°æ®åº“: INSERT INTO posts
    æ•°æ®åº“-->>åç«¯: è¿”å› ID
    åç«¯-->>å‰ç«¯: 201 Created
    å‰ç«¯-->>ç”¨æˆ·: æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯</code></pre>
      </details>
    </div>

    <h2>3. ç±»å›¾ï¼ˆClass Diagramï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        classDiagram
        class Post {
        +UUID id
        +String title
        +String content
        +DateTime created_at
        +create()
        +update()
        +delete()
        }

        class User {
        +UUID id
        +String username
        +String email
        +login()
        +logout()
        }

        class Category {
        +UUID id
        +String name
        +String slug
        }

        User "1" --> "*" Post : åˆ›å»º
        Post "*" --> "1" Category : å±äº
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">classDiagram
    class Post {
        +UUID id
        +String title
        +String content
        +DateTime created_at
        +create()
        +update()
        +delete()
    }

    class User {
        +UUID id
        +String username
        +String email
        +login()
        +logout()
    }

    class Category {
        +UUID id
        +String name
        +String slug
    }

    User "1" --> "*" Post : åˆ›å»º
    Post "*" --> "1" Category : å±äº</code></pre>
      </details>
    </div>

    <h2>4. çŠ¶æ€å›¾ï¼ˆState Diagramï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        stateDiagram-v2
        [*] --> è‰ç¨¿
        è‰ç¨¿ --> å®¡æ ¸ä¸­: æäº¤å®¡æ ¸
        å®¡æ ¸ä¸­ --> å·²å‘å¸ƒ: å®¡æ ¸é€šè¿‡
        å®¡æ ¸ä¸­ --> è‰ç¨¿: å®¡æ ¸æ‹’ç»
        å·²å‘å¸ƒ --> å·²å½’æ¡£: å½’æ¡£
        å·²å½’æ¡£ --> [*]
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">stateDiagram-v2
    [*] --> è‰ç¨¿
    è‰ç¨¿ --> å®¡æ ¸ä¸­: æäº¤å®¡æ ¸
    å®¡æ ¸ä¸­ --> å·²å‘å¸ƒ: å®¡æ ¸é€šè¿‡
    å®¡æ ¸ä¸­ --> è‰ç¨¿: å®¡æ ¸æ‹’ç»
    å·²å‘å¸ƒ --> å·²å½’æ¡£: å½’æ¡£
    å·²å½’æ¡£ --> [*]</code></pre>
      </details>
    </div>

    <h2>5. ç”˜ç‰¹å›¾ï¼ˆGantt Chartï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        gantt
        title é¡¹ç›®å¼€å‘è®¡åˆ’
        dateFormat YYYY-MM-DD
        section åç«¯å¼€å‘
        æ•°æ®åº“è®¾è®¡ :done, des1, 2024-01-01, 2024-01-05
        API å¼€å‘ :active, des2, 2024-01-06, 2024-01-15
        æµ‹è¯• : des3, 2024-01-16, 2024-01-20
        section å‰ç«¯å¼€å‘
        UI è®¾è®¡ :done, des4, 2024-01-01, 2024-01-08
        ç»„ä»¶å¼€å‘ :active, des5, 2024-01-09, 2024-01-18
        é›†æˆæµ‹è¯• : des6, 2024-01-19, 2024-01-25
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">gantt
    title é¡¹ç›®å¼€å‘è®¡åˆ’
    dateFormat  YYYY-MM-DD
    section åç«¯å¼€å‘
    æ•°æ®åº“è®¾è®¡           :done,    des1, 2024-01-01, 2024-01-05
    API å¼€å‘            :active,  des2, 2024-01-06, 2024-01-15
    æµ‹è¯•                :         des3, 2024-01-16, 2024-01-20
    section å‰ç«¯å¼€å‘
    UI è®¾è®¡             :done,    des4, 2024-01-01, 2024-01-08
    ç»„ä»¶å¼€å‘            :active,  des5, 2024-01-09, 2024-01-18
    é›†æˆæµ‹è¯•            :         des6, 2024-01-19, 2024-01-25</code></pre>
      </details>
    </div>

    <h2>6. é¥¼å›¾ï¼ˆPie Chartï¼‰</h2>
    <div class="diagram-container" data-type="mermaid">
      <div class="diagram-render mermaid">
        pie title ç¼–ç¨‹è¯­è¨€ä½¿ç”¨å æ¯”
        "Python" : 45
        "JavaScript" : 30
        "TypeScript" : 15
        "Go" : 10
      </div>
      <details class="diagram-source">
        <summary>æŸ¥çœ‹æºç </summary>
        <pre><code class="language-mermaid">pie title ç¼–ç¨‹è¯­è¨€ä½¿ç”¨å æ¯”
    "Python" : 45
    "JavaScript" : 30
    "TypeScript" : 15
    "Go" : 10</code></pre>
      </details>
    </div>
  </div>

  <script>
    // åˆå§‹åŒ– Mermaid
    mermaid.initialize({
      startOnLoad: false,
      theme: 'default',
      securityLevel: 'loose',
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis'
      }
    });

    // æ¸²æŸ“æ‰€æœ‰ Mermaid å›¾è¡¨
    async function renderDiagrams() {
      const diagrams = document.querySelectorAll('.diagram-render.mermaid');

      for (let i = 0; i < diagrams.length; i++) {
        const element = diagrams[i];
        const code = element.textContent.trim();
        const id = `mermaid-diagram-${i}`;

        try {
          // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
          element.innerHTML = '<div class="diagram-loading">æ­£åœ¨æ¸²æŸ“å›¾è¡¨...</div>';

          // æ¸²æŸ“å›¾è¡¨
          const { svg } = await mermaid.render(id, code);
          element.innerHTML = svg;

          console.log(`âœ… å›¾è¡¨ ${i + 1} æ¸²æŸ“æˆåŠŸ`);
        } catch (error) {
          console.error(`âŒ å›¾è¡¨ ${i + 1} æ¸²æŸ“å¤±è´¥:`, error);
          element.innerHTML = `
                        <div class="diagram-error">
                            <strong>å›¾è¡¨æ¸²æŸ“å¤±è´¥</strong><br>
                            ${error.message || 'æœªçŸ¥é”™è¯¯'}
                        </div>
                    `;
        }
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ¸²æŸ“
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸš€ å¼€å§‹æ¸²æŸ“å›¾è¡¨...');
      renderDiagrams();
    });

    // ä»£ç é«˜äº®
    document.addEventListener('DOMContentLoaded', () => {
      Prism.highlightAll();
    });
  </script>
</body>

</html>
