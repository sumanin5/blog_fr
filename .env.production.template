# =============================================================================
# 🚀 环境变量配置示例 (.env.example)
# =============================================================================
# 使用说明：
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 修改所有标注 "changethis" 的字段为真实值
# =============================================================================

# -----------------------------------------------------------------------------
# 1. 基础项目信息与域名配置
# -----------------------------------------------------------------------------
PROJECT_NAME="Blog FR"
STACK_NAME=blog-fr
ENVIRONMENT=development  # development / staging / production

# [核心] 域名配置
# 本地开发时不需要设置，Caddy 会使用默认值 localhost
# 生产环境必须设置以下三个域名：
DOMAIN_NAME=ty1547.com              # 主域名 (不带 www)
DOMAIN_NAME_WWW=www.ty1547.com      # www 域名
API_DOMAIN_NAME=api.ty1547.com      # API 子域名

# -----------------------------------------------------------------------------
# 2. 数据库配置 (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_SERVER=db                  # Docker: db, 本地开发: localhost
POSTGRES_PORT=5432
POSTGRES_DB=blog_fr
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changethis        # [重要] 生产环境必须修改

# 数据库连接串 (供后端应用使用)
DATABASE_URL=postgresql://postgres:changethis@db:5432/blog_fr
DATABASE_ECHO=False

# -----------------------------------------------------------------------------
# 3. 后端 API 服务配置 (FastAPI)
# -----------------------------------------------------------------------------
# API 基础配置
API_VERSION=v1
API_PREFIX=/api/v1
BASE_URL=http://localhost:8000              # 开发: localhost, 生产: https://api.ty1547.com
MEDIA_ROOT=media
MEDIA_URL=http://localhost:8000/media/      # 开发: localhost, 生产: https://api.ty1547.com/media/

# 安全与认证
# 生成密钥: openssl rand -hex 32
SECRET_KEY=changethis-please-use-openssl-rand-hex-32
ACCESS_TOKEN_EXPIRE_MINUTES=10080

# 初始超级管理员配置 (首次启动时自动创建)
FIRST_SUPERUSER=admin                       # 超级管理员用户名
FIRST_SUPERUSER_PASSWORD=changethis         # [重要] 超级管理员密码
FIRST_SUPERUSER_EMAIL=admin@example.com     # 超级管理员邮箱

# CORS 跨域配置 (允许前端域名访问后端)
# 开发环境示例:
BACKEND_CORS_ORIGINS=["http://localhost","http://localhost:3000","http://localhost:5173"]
# 生产环境示例:
# BACKEND_CORS_ORIGINS=["https://ty1547.com","https://www.ty1547.com","https://api.ty1547.com"]

# GitOps 内容同步
CONTENT_DIR=/git_root/content
GIT_AUTO_CREATE_CATEGORIES=True              # 是否自动创建分类
GIT_STRICT_STRUCTURE=False                   # 是否强制目录结构
GIT_DEFAULT_CATEGORY=uncategorized           # 默认分类别名
WEBHOOK_SECRET=changethis                    # GitHub Webhook 密钥

# [Docker 专用] 解决挂载权限问题
GIT_DISCOVERY_ACROSS_FILESYSTEM=1
GIT_CONFIG_PARAMETERS='safe.directory=*'

# GeoIP2 (用于访客地理位置识别，可选)
# MAXMIND_ACCOUNT_ID=
# MAXMIND_LICENSE_KEY=

# -----------------------------------------------------------------------------
# 4. 前端应用配置 (Next.js)
# -----------------------------------------------------------------------------
# [浏览器端] 访问的 API 地址
# 开发环境: http://localhost:8000
# 生产环境: 留空 (因为 API_PREFIX 已包含 /api/v1)
NEXT_PUBLIC_API_URL=http://localhost:8000

# [浏览器端] 站内 URL
# 开发环境: http://localhost:3000
# 生产环境: https://ty1547.com
FRONTEND_URL=http://localhost:3000

# [服务端 SSR] 内部访问后端的地址 (走 Docker 内网)
# Docker 环境: http://backend:8000
# 本地开发: http://localhost:8000
BACKEND_INTERNAL_URL=http://backend:8000

# Auth 功能开关与密钥
NEXT_PUBLIC_SHOW_AUTH_ENTRY=true
# Auth 门卫密码 (用于 /auth/gate 验证)
AUTH_GATE_SECRET=changethisregex
# 用于触发页面刷新 (ISR) 的密钥
# 生成密钥: openssl rand -hex 32
REVALIDATE_SECRET=changethis-please-use-openssl-rand-hex-32

# -----------------------------------------------------------------------------
# 5. 邮件服务配置 (可选 - 如需发送邮件请取消注释并配置)
# -----------------------------------------------------------------------------
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# EMAILS_FROM_EMAIL=noreply@yourdomain.com
# SMTP_TLS=True
# SMTP_SSL=False

# -----------------------------------------------------------------------------
# 6. 系统与权限 (Linux)
# -----------------------------------------------------------------------------
# 用于设置 Docker 容器内运行用户的 ID，建议与宿主机用户一致
# 获取当前用户 ID: id -u
UID=1000
GID=1000

# -----------------------------------------------------------------------------
# 7. 监控与日志 (可选)
# -----------------------------------------------------------------------------
# Sentry 错误追踪
SENTRY_DSN=                                  # Sentry DSN (留空则不启用)
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0                # 性能追踪采样率 (0.0-1.0)
# 前端 Sentry (需要 NEXT_PUBLIC_ 前缀)
NEXT_PUBLIC_SENTRY_DSN=

# OpenTelemetry (可选)
ENABLE_OPENTELEMETRY=False
OTEL_EXPORTER_ENDPOINT=http://localhost:4317

# 性能监控
SLOW_REQUEST_THRESHOLD=1.0                   # 慢请求阈值（秒）

# -----------------------------------------------------------------------------
# 8. 测试配置 (可选)
# -----------------------------------------------------------------------------
TEST_ADMIN_USERNAME=admin
TEST_ADMIN_PASSWORD=changethis

# -----------------------------------------------------------------------------
# 9. Docker 镜像配置 (如需推送到仓库)
# -----------------------------------------------------------------------------
# DOCKER_IMAGE_BACKEND=your-registry/backend
# DOCKER_IMAGE_FRONTEND=your-registry/frontend
