# =============================================================================
# 🚀 生产环境配置模板 (.env)
# =============================================================================
# 使用说明：
# 1. 在服务器部署目录 (/home/tomy/blog_fr) 下创建名为 .env 的文件
# 2. 将本文件内容复制进去
# 3. 修改所有标注 "CHANGEME" 的字段为真实值
# =============================================================================

# -----------------------------------------------------------------------------
# 1. 基础项目信息
# -----------------------------------------------------------------------------
PROJECT_NAME="Blog FR"
STACK_NAME=blog-fr
ENVIRONMENT=production

# [核心] 域名配置
# Caddy 将自动为这两个域名申请 HTTPS 证书
DOMAIN_NAME=CHANGEME_FRONTEND_DOMAIN         # 例如: www.myblog.com
API_DOMAIN_NAME=CHANGEME_API_DOMAIN          # 例如: api.myblog.com

# -----------------------------------------------------------------------------
# 2. 数据库配置 (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_SERVER=db
POSTGRES_PORT=5432
POSTGRES_DB=blog_fr
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGEME_DB_PASSWORD       # [重要] 设置强密码

# -----------------------------------------------------------------------------
# 3. 后端 API 服务配置 (FastAPI)
# -----------------------------------------------------------------------------
# 数据库连接串 (供后端应用使用)
DATABASE_URL=postgresql://postgres:CHANGEME_DB_PASSWORD@db:5432/blog_fr
DATABASE_ECHO=False

# API 基础配置
API_VERSION=v1
API_PREFIX=/api/v1
BASE_URL=https://CHANGEME_API_DOMAIN         # 后端公网地址
MEDIA_ROOT=media
MEDIA_URL=https://CHANGEME_API_DOMAIN/media/

# 安全与认证
SECRET_KEY=CHANGEME_SECRET_KEY               # [重要] 后端 Session 加密密钥 (可用 openssl rand -hex 32 生成)
ACCESS_TOKEN_EXPIRE_MINUTES=10080

# 初始超级管理员配置 (首次启动时自动创建)
FIRST_SUPERUSER=admin                        # 超级管理员用户名
FIRST_SUPERUSER_PASSWORD=CHANGEME_ADMIN_PASS # [重要] 超级管理员密码
FIRST_SUPERUSER_EMAIL=admin@example.com      # 超级管理员邮箱

# CORS 跨域配置 (允许前端域名访问后端)
BACKEND_CORS_ORIGINS=["https://CHANGEME_FRONTEND_DOMAIN","https://CHANGEME_API_DOMAIN"]

# GitOps 内容同步
CONTENT_DIR=/git_root/content
GIT_AUTO_CREATE_CATEGORIES=True              # 是否自动创建分类
GIT_STRICT_STRUCTURE=False                   # 是否强制目录结构
GIT_DEFAULT_CATEGORY=uncategorized           # 默认分类别名
# WEBHOOK_SECRET=your-webhook-secret-here    # GitHub Webhook Secret (可选)

# [Docker 专用] 解决挂载权限问题
GIT_DISCOVERY_ACROSS_FILESYSTEM=1
GIT_CONFIG_PARAMETERS='safe.directory=*'

# GeoIP2 (用于访客地理位置识别)
MAXMIND_ACCOUNT_ID=xxxx
MAXMIND_LICENSE_KEY=R0aAxxxx

# -----------------------------------------------------------------------------
# 4. 前端应用配置 (Next.js)
# -----------------------------------------------------------------------------
# [浏览器端] 访问的 API 地址
# 使用空字符串，因为 API_PREFIX 已经包含了 /api/v1
# Next.js rewrites 会自动将 /api/* 代理到后端
NEXT_PUBLIC_API_URL=

# [浏览器端] 站内 URL
FRONTEND_URL=https://CHANGEME_FRONTEND_DOMAIN

# [服务端 SSR] 内部访问后端的地址 (走 Docker 内网，速度快)
BACKEND_INTERNAL_URL=http://backend:8000

# Auth 功能开关与密钥
NEXT_PUBLIC_SHOW_AUTH_ENTRY=false
AUTH_GATE_SECRET=CHANGEME_AUTH_GATE          # 访问 /auth/gate 页面所需的口令
REVALIDATE_SECRET=CHANGEME_REVALIDATE_KEY    # 用于触发页面刷新 (ISR) 的密钥

# -----------------------------------------------------------------------------
# 5. 邮件服务配置 (可选 - 如需发送邮件请取消注释并配置)
# -----------------------------------------------------------------------------
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# EMAILS_FROM_EMAIL=noreply@yourdomain.com
# SMTP_TLS=True
# SMTP_SSL=False

# -----------------------------------------------------------------------------
# 6. 系统与权限 (Linux)
# -----------------------------------------------------------------------------
#用于设置 Docker 容器内运行用户的 ID，建议与宿主机用户一致(id -u)以避免挂载权限问题
UID=1000
GID=1000

# -----------------------------------------------------------------------------
# 7. 监控与日志 (可选)
# -----------------------------------------------------------------------------
# Sentry 错误追踪（不使用请注释掉或删除此行）
# SENTRY_DSN=your-sentry-dsn-here
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1                # 性能追踪采样率 (0.0-1.0)

# OpenTelemetry (可选)
ENABLE_OPENTELEMETRY=False
OTEL_EXPORTER_ENDPOINT=http://localhost:4317

# 性能监控
SLOW_REQUEST_THRESHOLD=1.0                   # 慢请求阈值（秒）
