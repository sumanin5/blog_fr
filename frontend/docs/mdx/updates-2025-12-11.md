# MDX 组件调整与复用说明（2025-12-11）

## 本轮调整内容
- **Mermaid 渲染链路**：`CodeBlock` 读取 DOM 原始文本，保留换行后交给 `MermaidChart`，避免被高亮器改写导致解析错误。
- **Mermaid 展示统一**：外层容器将设置固定浅灰背景、圆角和边框，并限制最小/最大宽度，保证各类图一致的可读尺寸。
- **React Flow 噪音消除**：提供稳定的 `nodeTypes/edgeTypes`，并在开发环境过滤重复警告，避免干扰调试。
- **MDX 结构清理**：`mdx-components-clean` 避免 `<p>` 内嵌块级元素，图片/表格/代码块布局更稳定。

## 在博客文章中复用 MDX 组件的方式
1. **在页面包裹 MDXProvider**
   ```tsx
   import { MDXProvider } from "@/components/mdx";
   import PostContent from "@/content/your-post.mdx";

   export default function BlogPost() {
     return (
       <MDXProvider>
         <PostContent />
       </MDXProvider>
     );
   }
   ```
2. **Mermaid / 代码块用法**：在 MDX 中直接书写 fenced code，例如：
   ````mdx
   ```mermaid
   graph TD
     A[开始] --> B{是否登录?}
     B -->|是| C[显示主页]
     B -->|否| D[跳转登录页]
   ```
   ```typescript
   const msg = "hello";
   ```
   ````
   代码块会自动套用 `CodeBlock`，Mermaid 会转为图表并附带“查看源码”折叠。
3. **表格/图片/提示等**：MDX 默认映射到 shadcn Table、定制 Img，以及 React 组件示例（Card/Alert/Flow）。正常写 Markdown 即可。
4. **复用 React Flow 示例**：在 MDX 中直接写 `<SimpleFlowExample />` 或 `<SystemArchExample />`。

## 开发注意
- 需要自定义 MDX 组件时，统一改动 `src/components/mdx/mdx-components-clean.tsx` 并通过 `MDXProvider` 提供。
- 如新增 MDX 文件，请保持代码块语言标注（如 ` ```mermaid`、` ```ts`）以获得正确高亮与图表渲染。
- 运行时如看到 Mermaid 渲染错误，请检查代码块是否存在语法问题或缩进缺失。
