# å‰ç«¯æµ‹è¯•æ¡†æ¶ä»‹ç»ä¸å¯¹æ¯”

## 1. æµ‹è¯•æ¡†æ¶ç”Ÿæ€æ¦‚è§ˆ

å‰ç«¯æµ‹è¯•é¢†åŸŸæœ‰å¤šç§å·¥å…·ï¼Œå®ƒä»¬å„å¸å…¶èŒï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æµ‹è¯•å·¥å…·æ ˆ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  E2E æµ‹è¯•        â”‚  Playwright âœ¨ â”‚ Cypress â”‚ Puppeteer         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç»„ä»¶/é›†æˆæµ‹è¯•    â”‚  React Testing Library âœ¨                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµ‹è¯•è¿è¡Œå™¨       â”‚  Vitest âœ¨     â”‚ Jest    â”‚ Mocha             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é™æ€åˆ†æ         â”‚  TypeScript   â”‚ ESLint                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    âœ¨ = æœ¬é¡¹ç›®ä½¿ç”¨
```

---

## 2. æµ‹è¯•è¿è¡Œå™¨ï¼ˆTest Runnerï¼‰

æµ‹è¯•è¿è¡Œå™¨è´Ÿè´£ï¼šæ‰§è¡Œæµ‹è¯•ã€æŠ¥å‘Šç»“æœã€ç®¡ç†æµ‹è¯•ç¯å¢ƒã€‚

### 2.1 Vitest â­ æ¨è

**å®˜ç½‘**: https://vitest.dev

**ç‰¹ç‚¹**ï¼š

- ğŸš€ **æå¿«**ï¼šåŸç”Ÿæ”¯æŒ ES Modulesï¼Œåˆ©ç”¨ Vite çš„å³æ—¶ç¼–è¯‘
- ğŸ”§ **é›¶é…ç½®**ï¼šè‡ªåŠ¨å¤ç”¨ Vite é…ç½®ï¼ˆaliasã€plugins ç­‰ï¼‰
- ğŸ¯ **å…¼å®¹ Jest**ï¼šAPI å‡ ä¹å®Œå…¨å…¼å®¹ Jestï¼Œè¿ç§»æˆæœ¬ä½
- ğŸ–¥ï¸ **ä¼˜ç§€çš„ UI**ï¼šå†…ç½®æ¼‚äº®çš„æµ‹è¯• UI ç•Œé¢

**é€‚ç”¨åœºæ™¯**ï¼šVite é¡¹ç›®çš„é¦–é€‰

```bash
# è¿è¡Œæµ‹è¯•
npm test

# å¸¦ UI ç•Œé¢
npm run test:ui
```

### 2.2 Jest

**å®˜ç½‘**: https://jestjs.io

**ç‰¹ç‚¹**ï¼š

- ğŸ“¦ å¼€ç®±å³ç”¨ï¼Œç”Ÿæ€æˆç†Ÿ
- ğŸ”„ å¿«ç…§æµ‹è¯•ï¼ˆSnapshot Testingï¼‰
- ğŸ“Š å†…ç½®è¦†ç›–ç‡æŠ¥å‘Š

**ç¼ºç‚¹**ï¼š

- å¯¹ ES Modules æ”¯æŒè¾ƒå¼±
- ä¸ Vite é…åˆéœ€è¦é¢å¤–é…ç½®
- ç›¸æ¯” Vitest é€Ÿåº¦è¾ƒæ…¢

**é€‚ç”¨åœºæ™¯**ï¼šCreate React Appã€Webpack é¡¹ç›®

### 2.3 å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§       | Vitest        | Jest        |
| ---------- | ------------- | ----------- |
| é€Ÿåº¦       | âš¡ æå¿«       | ğŸ¢ è¾ƒæ…¢     |
| Vite é›†æˆ  | âœ… åŸç”Ÿæ”¯æŒ   | âš ï¸ éœ€è¦é…ç½® |
| ES Modules | âœ… åŸç”Ÿæ”¯æŒ   | âš ï¸ éœ€è¦è½¬æ¢ |
| API å…¼å®¹æ€§ | Jest å…¼å®¹     | -           |
| UI ç•Œé¢    | âœ… å†…ç½®       | éœ€è¦ç¬¬ä¸‰æ–¹  |
| ç”Ÿæ€æˆç†Ÿåº¦ | ğŸŒ± å¹´è½»ä½†æ´»è·ƒ | ğŸŒ³ éå¸¸æˆç†Ÿ |

---

## 3. ç»„ä»¶æµ‹è¯•åº“

### 3.1 React Testing Library â­ æ¨è

**å®˜ç½‘**: https://testing-library.com/docs/react-testing-library/intro

**æ ¸å¿ƒç†å¿µ**ï¼š

> "The more your tests resemble the way your software is used, the more confidence they can give you."
>
> ä½ çš„æµ‹è¯•è¶Šæ¥è¿‘ç”¨æˆ·ä½¿ç”¨è½¯ä»¶çš„æ–¹å¼ï¼Œå®ƒå°±èƒ½ç»™ä½ è¶Šå¤šçš„ä¿¡å¿ƒã€‚

**ç‰¹ç‚¹**ï¼š

- ğŸ¯ **ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒ**ï¼šé¼“åŠ±é€šè¿‡å¯è®¿é—®æ€§å±æ€§ï¼ˆroleã€labelï¼‰æŸ¥æ‰¾å…ƒç´ 
- ğŸš« **ä¸æš´éœ²å®ç°ç»†èŠ‚**ï¼šæ— æ³•ç›´æ¥è®¿é—®ç»„ä»¶çŠ¶æ€æˆ–å†…éƒ¨æ–¹æ³•
- â™¿ **ä¿ƒè¿›å¯è®¿é—®æ€§**ï¼šå¦‚æœ `getByRole` æ‰¾ä¸åˆ°å…ƒç´ ï¼Œè¯´æ˜ä½ çš„ç»„ä»¶å¯èƒ½æœ‰å¯è®¿é—®æ€§é—®é¢˜
- ğŸ“š **ä¼˜ç§€çš„æ–‡æ¡£**ï¼šæä¾›æ¸…æ™°çš„æœ€ä½³å®è·µæŒ‡å—

**æ ¸å¿ƒ API**ï¼š

```tsx
import { render, screen } from "@testing-library/react";
import userEvent from "@testing-library/user-event";

// render: æ¸²æŸ“ç»„ä»¶åˆ°è™šæ‹Ÿ DOM
render(<MyComponent />);

// screen: æŸ¥è¯¢ DOM å…ƒç´ 
screen.getByRole("button");
screen.getByText("Hello");
screen.findByRole("alert"); // å¼‚æ­¥æŸ¥è¯¢

// userEvent: æ¨¡æ‹Ÿç”¨æˆ·äº¤äº’
const user = userEvent.setup();
await user.click(button);
await user.type(input, "Hello");
```

### 3.2 Enzymeï¼ˆå·²ä¸æ¨èï¼‰

Enzyme æ›¾æ˜¯ React æµ‹è¯•çš„ä¸»æµé€‰æ‹©ï¼Œä½†ç°åœ¨**å·²è¢«å¼ƒç”¨**ï¼š

- âŒ ä¸æ”¯æŒ React 18+
- âŒ é¼“åŠ±æµ‹è¯•å®ç°ç»†èŠ‚
- âŒ ç¤¾åŒºä¸å†ç»´æŠ¤

**å¦‚æœçœ‹åˆ°è€é¡¹ç›®ä½¿ç”¨ Enzymeï¼Œå»ºè®®è¿ç§»åˆ° React Testing Libraryã€‚**

---

## 4. E2E æµ‹è¯•æ¡†æ¶

E2Eï¼ˆEnd-to-Endï¼‰æµ‹è¯•æ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œï¼Œæ¶µç›–æ•´ä¸ªåº”ç”¨æµç¨‹ã€‚

### 4.1 Playwright â­ æ¨è

**å®˜ç½‘**: https://playwright.dev

**ç‰¹ç‚¹**ï¼š

- ğŸŒ **è·¨æµè§ˆå™¨**ï¼šä¸€å¥—ä»£ç æµ‹è¯• Chromeã€Firefoxã€Safari
- ğŸ“± **ç§»åŠ¨ç«¯æ¨¡æ‹Ÿ**ï¼šå†…ç½®è®¾å¤‡æ¨¡æ‹Ÿï¼ˆiPhoneã€Pixel ç­‰ï¼‰
- ğŸ¬ **è°ƒè¯•ç¥å™¨**ï¼šå½•åˆ¶è§†é¢‘ã€æˆªå›¾ã€Trace Viewer
- âš¡ **å¿«é€Ÿå¯é **ï¼šè‡ªåŠ¨ç­‰å¾…ã€è‡ªåŠ¨é‡è¯•
- ğŸ”§ **å¼€å‘è€…ä½“éªŒ**ï¼šVS Code æ’ä»¶ã€Codegen è‡ªåŠ¨ç”Ÿæˆä»£ç 

**é€‚ç”¨åœºæ™¯**ï¼š

- æµ‹è¯•å…³é”®ä¸šåŠ¡æµç¨‹ï¼ˆç™»å½•ã€æ”¯ä»˜ã€è¡¨å•æäº¤ï¼‰
- è·¨æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- è§†è§‰å›å½’æµ‹è¯•

```typescript
import { test, expect } from "@playwright/test";

test("ç”¨æˆ·å¯ä»¥ç™»å½•", async ({ page }) => {
  await page.goto("/login");
  await page.getByLabel("é‚®ç®±").fill("user@example.com");
  await page.getByLabel("å¯†ç ").fill("password");
  await page.getByRole("button", { name: "ç™»å½•" }).click();

  await expect(page).toHaveURL("/dashboard");
});
```

### 4.2 Cypress

**å®˜ç½‘**: https://www.cypress.io

**ç‰¹ç‚¹**ï¼š

- ğŸ¥ **å®æ—¶é¢„è§ˆ**ï¼šè¾¹å†™è¾¹çœ‹æ•ˆæœ
- ğŸ“¸ **è‡ªåŠ¨æˆªå›¾**ï¼šå¤±è´¥è‡ªåŠ¨ä¿å­˜æˆªå›¾
- ğŸ• **æ—¶é—´æ—…è¡Œ**ï¼šå›æ”¾æ¯ä¸€æ­¥æ“ä½œ

**ç¼ºç‚¹**ï¼š

- åªæ”¯æŒ Chromium æµè§ˆå™¨ï¼ˆSafari/Firefox æ”¯æŒæœ‰é™ï¼‰
- å…è´¹ç‰ˆåŠŸèƒ½æœ‰é™
- å¤šæ ‡ç­¾é¡µæ”¯æŒå¼±

**é€‚ç”¨åœºæ™¯**ï¼šå°å‹é¡¹ç›®ã€åªéœ€è¦ Chrome æµ‹è¯•

### 4.3 å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§         | Playwright            | Cypress                |
| ------------ | --------------------- | ---------------------- |
| æµè§ˆå™¨æ”¯æŒ   | Chrome/Firefox/Safari | ä¸»è¦æ˜¯ Chrome          |
| ç§»åŠ¨è®¾å¤‡æ¨¡æ‹Ÿ | âœ… åŸç”Ÿæ”¯æŒ           | âš ï¸ æœ‰é™                |
| å¤šæ ‡ç­¾é¡µ     | âœ… æ”¯æŒ               | âŒ ä¸æ”¯æŒ              |
| å¹¶è¡Œæµ‹è¯•     | âœ… åŸç”Ÿæ”¯æŒ           | éœ€è¦ä»˜è´¹ç‰ˆ             |
| å­¦ä¹ æ›²çº¿     | ä¸­ç­‰                  | è¾ƒä½                   |
| ç¤¾åŒºæ´»è·ƒåº¦   | ğŸ”¥ éå¸¸æ´»è·ƒ           | ğŸ“ˆ æ´»è·ƒ                |
| å¼€æºç¨‹åº¦     | å®Œå…¨å¼€æº              | æ ¸å¿ƒå¼€æºï¼Œé«˜çº§åŠŸèƒ½ä»˜è´¹ |

---

## 5. è¾…åŠ©å·¥å…·

### 5.1 @testing-library/jest-dom

æ‰©å±•æ–­è¨€æ–¹æ³•ï¼Œè®©æµ‹è¯•æ›´æ˜“è¯»ï¼š

```tsx
// åŸç”Ÿæ–­è¨€
expect(element.className).toContain("visible");

// jest-dom æ–­è¨€ï¼ˆæ›´è¯­ä¹‰åŒ–ï¼‰
expect(element).toBeVisible();
expect(element).toHaveClass("visible");
expect(element).toBeInTheDocument();
expect(element).toHaveTextContent("Hello");
```

### 5.2 @testing-library/user-event

æ¯” `fireEvent` æ›´çœŸå®çš„ç”¨æˆ·äº¤äº’æ¨¡æ‹Ÿï¼š

```tsx
import userEvent from "@testing-library/user-event";

// fireEvent: ç›´æ¥è§¦å‘äº‹ä»¶
fireEvent.click(button);

// userEvent: æ¨¡æ‹Ÿå®Œæ•´çš„ç”¨æˆ·è¡Œä¸º
// ï¼ˆåŒ…æ‹¬ focusã€hoverã€mousedownã€mouseupã€clickï¼‰
const user = userEvent.setup();
await user.click(button);
```

### 5.3 MSW (Mock Service Worker)

ä¼˜é›…åœ° Mock API è¯·æ±‚ï¼š

```tsx
import { rest } from "msw";
import { setupServer } from "msw/node";

const server = setupServer(
  rest.get("/api/user", (req, res, ctx) => {
    return res(ctx.json({ name: "John" }));
  }),
);

beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());
```

---

## 6. æœ¬é¡¹ç›®æŠ€æœ¯æ ˆ

æœ¬é¡¹ç›®é€‰æ‹©çš„æµ‹è¯•å·¥å…·æ ˆï¼š

| å±‚çº§       | å·¥å…·                            | ç”¨é€”                   |
| ---------- | ------------------------------- | ---------------------- |
| æµ‹è¯•è¿è¡Œå™¨ | **Vitest**                      | æ‰§è¡Œæµ‹è¯•ã€ç”ŸæˆæŠ¥å‘Š     |
| ç»„ä»¶æµ‹è¯•   | **React Testing Library**       | æ¸²æŸ“ç»„ä»¶ã€æ¨¡æ‹Ÿç”¨æˆ·äº¤äº’ |
| æ–­è¨€æ‰©å±•   | **@testing-library/jest-dom**   | æ›´è¯­ä¹‰åŒ–çš„æ–­è¨€æ–¹æ³•     |
| ç”¨æˆ·äº¤äº’   | **@testing-library/user-event** | çœŸå®çš„ç”¨æˆ·è¡Œä¸ºæ¨¡æ‹Ÿ     |
| E2E æµ‹è¯•   | **Playwright**                  | ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹æµ‹è¯•     |

ä¸‹ä¸€ç¯‡ï¼š[Vitest + React Testing Library æŒ‡å—](./03-vitest-rtl-guide.md)
