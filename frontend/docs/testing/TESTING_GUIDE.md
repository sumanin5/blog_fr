<!--
  ğŸ“š å‰ç«¯æµ‹è¯•å®Œå…¨æŒ‡å— - é›†æˆæµ‹è¯•å…¥é—¨

  è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å­¦ä¹ æ–‡æ¡£ï¼Œå¸¦ä½ ç†è§£å’Œå®è·µå‰ç«¯æµ‹è¯•ã€‚
-->

# ğŸš€ å‰ç«¯æµ‹è¯•å®Œå…¨å…¥é—¨æŒ‡å—

## ç›®å½•

1. [æµ‹è¯•æ¦‚å¿µ](#æµ‹è¯•æ¦‚å¿µ)
2. [æµ‹è¯•é‡‘å­—å¡”](#æµ‹è¯•é‡‘å­—å¡”)
3. [é›†æˆæµ‹è¯•è¯¦è§£](#é›†æˆæµ‹è¯•è¯¦è§£)
4. [ä½ çš„å­¦ä¹ è·¯çº¿](#ä½ çš„å­¦ä¹ è·¯çº¿)
5. [å¸¸ç”¨ API é€ŸæŸ¥è¡¨](#å¸¸ç”¨-api-é€ŸæŸ¥è¡¨)

---

## æµ‹è¯•æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯å‰ç«¯æµ‹è¯•ï¼Ÿ

**å®šä¹‰**ï¼šè‡ªåŠ¨åŒ–éªŒè¯ä»£ç è¡Œä¸ºæ˜¯å¦ç¬¦åˆé¢„æœŸçš„è¿‡ç¨‹ã€‚

**ç›®çš„**ï¼š

- âœ… å‘ç° Bugï¼ˆåœ¨éƒ¨ç½²å‰ï¼‰
- âœ… æé«˜ä»£ç è´¨é‡ï¼ˆé‡æ„æ—¶æ”¾å¿ƒï¼‰
- âœ… æ–‡æ¡£ä½œç”¨ï¼ˆä»£ç å¦‚ä½•ä½¿ç”¨ï¼‰
- âœ… åŠ å¿«å¼€å‘é€Ÿåº¦ï¼ˆåé¦ˆå¿«ï¼‰

### ä¸ºä»€ä¹ˆéœ€è¦æµ‹è¯•ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼š

```
âŒ ä¸å†™æµ‹è¯•çš„æµç¨‹ï¼š
  ä¿®æ”¹ä»£ç  â†’ æ‰‹åŠ¨æµ‹è¯•ï¼ˆ1å°æ—¶ï¼‰â†’ å‘ç° Bug â†’ ä¿®æ”¹ â†’ å†æµ‹è¯•...

âœ… å†™æµ‹è¯•çš„æµç¨‹ï¼š
  ä¿®æ”¹ä»£ç  â†’ è‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼ˆ10ç§’ï¼‰â†’ ç«‹å³å‘ç°é—®é¢˜
```

---

## æµ‹è¯•é‡‘å­—å¡”

### å¯è§†åŒ–

```
        ğŸ­ E2E æµ‹è¯• (10%)
       /  \
      /    \          å®Œæ•´ç”¨æˆ·åœºæ™¯
     /      \         é€šè¿‡çœŸå®æµè§ˆå™¨æµ‹è¯•
    /  é«˜ä»·å€¼ \        æ…¢ï¼ˆ5-30ç§’ï¼‰
   /________\

  /            \
 /  é›†æˆæµ‹è¯•    \      å¤šä¸ªå•å…ƒåä½œ
/      (30%)   \      ç»„ä»¶é—´äº¤äº’
/______________\      ä¸­é€Ÿï¼ˆ100-500msï¼‰

/                \
/ å•å…ƒæµ‹è¯•         \    å•ä¸ªå‡½æ•°/ç»„ä»¶
/      (60%)      \    ç‹¬ç«‹æµ‹è¯•
/__________________\ å¿«ï¼ˆ<50msï¼‰
```

### æ¯å±‚çš„ç‰¹ç‚¹å¯¹æ¯”

| ç‰¹æ€§         | å•å…ƒ     | é›†æˆ     | E2E      |
| ------------ | -------- | -------- | -------- |
| **é€Ÿåº¦**     | âš¡ å¿«    | âš¡âš¡ ä¸­  | ğŸŒ æ…¢    |
| **æˆæœ¬**     | ğŸ’° ä½    | ğŸ’° ä¸­    | ğŸ’¸ é«˜    |
| **è¦†ç›–ç‡**   | ä½       | ä¸­       | é«˜       |
| **è°ƒè¯•éš¾åº¦** | ç®€å•     | ä¸­ç­‰     | å›°éš¾     |
| **ç»´æŠ¤æˆæœ¬** | ä½       | ä¸­       | é«˜       |
| **ä»£è¡¨åœºæ™¯** | å·¥å…·å‡½æ•° | ç»„ä»¶äº¤äº’ | å®Œæ•´æµç¨‹ |

### ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ¯”ä¾‹ï¼Ÿ

```
ä½ çš„ä»£ç ä¸­ï¼š
- 60% çš„ Bug åœ¨å•å…ƒå±‚é¢å°±èƒ½å‘ç°ï¼ˆé€»è¾‘é”™è¯¯ï¼‰
- 30% çš„ Bug åœ¨é›†æˆå±‚èƒ½å‘ç°ï¼ˆç»„ä»¶äº¤äº’é—®é¢˜ï¼‰
- 10% çš„ Bug éœ€è¦ E2E æ‰èƒ½å‘ç°ï¼ˆè¾¹ç•Œæƒ…å†µã€è·¨é¡µé¢æµç¨‹ï¼‰

æ‰€ä»¥ï¼š
- å•å…ƒæµ‹è¯•ï¼šå¹¿æ³›è¦†ç›–ï¼Œå¿«é€Ÿåé¦ˆ
- é›†æˆæµ‹è¯•ï¼šéªŒè¯ç»„ä»¶åä½œï¼Œæˆæœ¬æ•ˆç›Šå¥½
- E2E æµ‹è¯•ï¼šä¿é™©ç½‘ï¼Œåªæµ‹å…³é”®è·¯å¾„
```

---

## é›†æˆæµ‹è¯•è¯¦è§£

### ä»€ä¹ˆæ˜¯é›†æˆæµ‹è¯•ï¼Ÿ

**å®šä¹‰**ï¼šæµ‹è¯•å¤šä¸ªå•å…ƒï¼ˆç»„ä»¶ã€å‡½æ•°ã€æœåŠ¡ï¼‰åä½œæ˜¯å¦æ­£å¸¸ã€‚

**èŒƒå›´**ï¼š

```
å•ä¸ªå‡½æ•°        å•ä¸ªç»„ä»¶        å¤šä¸ªç»„ä»¶        å®Œæ•´é¡µé¢        è·¨é¡µé¢æµç¨‹
  â†‘                â†‘              â†‘              â†‘                â†‘
å•å…ƒæµ‹è¯•      å•å…ƒæµ‹è¯•        é›†æˆæµ‹è¯•       é›†æˆæµ‹è¯•         E2E æµ‹è¯•
                                â†â†’â† é›†æˆæµ‹è¯• â†â†’â†

åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼š
âœ… Login ç»„ä»¶ + è¡¨å•éªŒè¯ + è·¯ç”± = é›†æˆæµ‹è¯•
âœ… ç™»å½• + è·³è½¬é¦–é¡µ + ä¸»é¢˜æ¸²æŸ“ = é›†æˆæµ‹è¯•
âŒ å•ä¸ªå¯†ç éªŒè¯å‡½æ•° = å•å…ƒæµ‹è¯•
âŒ å®Œæ•´çš„ç™»å½• â†’ åˆ›å»ºæ–‡ç«  â†’ å‘å¸ƒæµç¨‹ = E2E æµ‹è¯•
```

### é›†æˆæµ‹è¯•æµ‹ä»€ä¹ˆï¼Ÿ

å¯¹äº Login é¡µé¢ï¼š

```
âœ… åº”è¯¥æµ‹è¯•ï¼š
- è¡¨å•èƒ½å¦æ­£ç¡®æ¸²æŸ“
- ç”¨æˆ·èƒ½å¦è¾“å…¥æ•°æ®
- è¡¨å•éªŒè¯æ˜¯å¦å·¥ä½œ
- é”™è¯¯ä¿¡æ¯æ˜¯å¦æ˜¾ç¤º
- æäº¤åè·¯ç”±æ˜¯å¦è·³è½¬
- å¤šä¸ªå­—æ®µçš„äº¤äº’é€»è¾‘

âŒ ä¸åº”è¯¥æµ‹è¯•ï¼š
- åç«¯ APIï¼ˆé‚£æ˜¯åç«¯çš„è´£ä»»ï¼‰
- æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆé‚£æ˜¯ E2E æµ‹è¯•çš„äº‹ï¼‰
- å…·ä½“çš„ CSS æ ·å¼ï¼ˆé™¤éå…³äºåŠŸèƒ½çš„ï¼‰
- ç¬¬ä¸‰æ–¹åº“çš„å†…éƒ¨é€»è¾‘
```

### é›†æˆæµ‹è¯•çš„æ­¥éª¤

```
1ï¸âƒ£ å‡†å¤‡ï¼ˆSetupï¼‰
   â””â”€ æ¸²æŸ“ç»„ä»¶ã€è®¾ç½® Mockã€åˆå§‹åŒ–çŠ¶æ€

2ï¸âƒ£ æ‰§è¡Œï¼ˆActï¼‰
   â””â”€ æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼ˆç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰ï¼‰

3ï¸âƒ£ éªŒè¯ï¼ˆAssertï¼‰
   â””â”€ æ£€æŸ¥ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸ
```

**ä»£ç ç¤ºä¾‹**ï¼š

```typescript
describe("Login", () => {
  it("should show error when submitting empty form", async () => {
    // 1ï¸âƒ£ å‡†å¤‡ï¼šæ¸²æŸ“ç»„ä»¶
    const { getByRole } = render(<Login />);

    // 2ï¸âƒ£ æ‰§è¡Œï¼šæ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡»
    const button = getByRole("button", { name: /login/i });
    await userEvent.click(button);

    // 3ï¸âƒ£ éªŒè¯ï¼šæ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºé”™è¯¯
    expect(screen.getByText(/please fill/i)).toBeInTheDocument();
  });
});
```

---

## ä½ çš„å­¦ä¹ è·¯çº¿

### ğŸ“… å»ºè®®æ—¶é—´è¡¨

```
ç¬¬ 1 å‘¨ï¼šç†è§£æµ‹è¯•æ¦‚å¿µï¼ˆä½ ç°åœ¨è¿™é‡Œï¼‰
  Day 1-2: é˜…è¯»æœ¬æ–‡æ¡£
  Day 3-4: è¿è¡Œç°æœ‰çš„ç¤ºä¾‹æµ‹è¯•
  Day 5-7: ä¿®æ”¹ç¤ºä¾‹ï¼Œå°è¯•ç¼–å†™ç®€å•çš„æµ‹è¯•

ç¬¬ 2 å‘¨ï¼šå†™ç¬¬ä¸€ä¸ªé›†æˆæµ‹è¯•
  Day 1-3: ä¸º Login ç»„ä»¶å†™å®Œæ•´çš„é›†æˆæµ‹è¯•
  Day 4-5: ä¸º Register ç»„ä»¶å†™é›†æˆæµ‹è¯•
  Day 6-7: ä¸ºè¡¨å•éªŒè¯å†™é›†æˆæµ‹è¯•

ç¬¬ 3 å‘¨ï¼šæ·±å…¥é›†æˆæµ‹è¯•
  Day 1-3: ä¸ºè·¯ç”±å¯¼èˆªå†™æµ‹è¯•
  Day 4-7: ä¸ºä¸»é¢˜åˆ‡æ¢å†™æµ‹è¯•

ç¬¬ 4 å‘¨ï¼šE2E æµ‹è¯•
  (åŸºäºé›†æˆæµ‹è¯•çš„åŸºç¡€)
```

### ğŸ¯ å½“å‰é˜¶æ®µï¼šé›†æˆæµ‹è¯•

ä¸ºä»€ä¹ˆä»é›†æˆæµ‹è¯•å¼€å§‹ï¼Ÿ

1. âœ… **ä½ çš„ç»„ä»¶å·²ç»å®Œæˆ**
   - Loginã€Register éƒ½å†™å¥½äº†
   - æœ‰å®é™…çš„ä»£ç å¯ä»¥æµ‹è¯•

2. âœ… **æœ€é«˜çš„æŠ•èµ„å›æŠ¥ç‡ (ROI)**
   - 30% çš„ä»£ç è¦†ç›–ç‡ = å‘ç° 80% çš„ Bug
   - æ¯”å•å…ƒæµ‹è¯•æœ‰æ„ä¹‰
   - æ¯” E2E æµ‹è¯•å¿«

3. âœ… **å®¹æ˜“ä¸Šæ‰‹**
   - React Testing Library å¾ˆç›´è§‚
   - å­¦ä¹ æ›²çº¿å¹³ç¼“
   - å¿«é€Ÿçœ‹åˆ°æˆæœ

4. âœ… **å»ºç«‹ä¿¡å¿ƒ**
   - å†™å‡ºæ¥çš„æµ‹è¯•é€šè¿‡
   - ä¿®æ”¹ä»£ç æ—¶æµ‹è¯•ä¹Ÿé€šè¿‡
   - äº§ç”Ÿ"æœ‰ä¿éšœ"çš„æ„Ÿè§‰

---

## å¸¸ç”¨ API é€ŸæŸ¥è¡¨

### ğŸ” æŸ¥æ‰¾å…ƒç´  (Queries)

```typescript
// æœ€æ¨èï¼šæŒ‰è§’è‰²æŸ¥æ‰¾ï¼ˆæ— éšœç¢ä¼˜å…ˆï¼‰
screen.getByRole("button", { name: /login/i });
screen.getByRole("textbox", { name: /username/i });

// æ¬¡æ¨èï¼šæŒ‰æ ‡ç­¾æŸ¥æ‰¾
screen.getByLabelText(/email/i);

// æŒ‰æ–‡æœ¬æŸ¥æ‰¾
screen.getByText("Click me");

// æŒ‰å ä½ç¬¦æŸ¥æ‰¾
screen.getByPlaceholderText("Enter name");

// æŒ‰æµ‹è¯•IDæŸ¥æ‰¾ï¼ˆæœ€åæ‰ç”¨ï¼‰
screen.getByTestId("submit-button");

// å·®å¼‚ï¼šgetBy vs queryBy vs findBy
getByX(); // æ‰¾ä¸åˆ°ä¼šæŠ›é”™ï¼ˆåŒæ­¥ï¼‰
queryByX(); // æ‰¾ä¸åˆ°è¿”å› nullï¼ˆåŒæ­¥ï¼‰
findByX(); // å¼‚æ­¥ç­‰å¾…å…ƒç´ å‡ºç°
```

### âš™ï¸ ç”¨æˆ·äº¤äº’

```typescript
import userEvent from "@testing-library/user-event";

const user = userEvent.setup();

// è¾“å…¥æ–‡æœ¬
await user.type(input, "hello");

// æ¸…ç©ºæ–‡æœ¬
await user.clear(input);

// ç‚¹å‡»
await user.click(button);

// åŒå‡»
await user.dblClick(button);

// Tab é”®å¯¼èˆª
await user.tab();

// é€‰æ‹©é€‰é¡¹
await user.selectOptions(select, "option1");

// ä¸Šä¼ æ–‡ä»¶
await user.upload(fileInput, file);
```

### â±ï¸ å¼‚æ­¥ç­‰å¾…

```typescript
import { waitFor } from "@testing-library/react";

// ç­‰å¾…æŸä¸ªå…ƒç´ å‡ºç°
await waitFor(() => {
  expect(screen.getByText("Success")).toBeInTheDocument();
});

// ç­‰å¾…ç‰¹å®šæ¡ä»¶
await waitFor(
  () => {
    expect(mockFn).toHaveBeenCalledWith("value");
  },
  { timeout: 3000 },
);

// ç­‰å¾…å…ƒç´ æ¶ˆå¤±
await waitFor(() => {
  expect(screen.queryByText("Loading")).not.toBeInTheDocument();
});
```

### âœ… æ–­è¨€ (Assertions)

```typescript
// å­˜åœ¨æ€§
expect(element).toBeInTheDocument();
expect(element).toBeVisible();

// å±æ€§
expect(input).toHaveValue("text");
expect(button).toBeDisabled();
expect(input).toHaveFocus();

// æ ·å¼
expect(div).toHaveClass("active");
expect(div).toHaveStyle("color: red");

// æ–‡æœ¬
expect(element).toHaveTextContent("hello");
expect(element).toHaveTextContent(/hello/i);

// æ•°é‡
expect(screen.getAllByRole("button")).toHaveLength(3);
```

---

## ğŸ¬ ç°åœ¨å¼€å§‹å®æˆ˜

### æ­¥éª¤ 1ï¼šè¿è¡Œç°æœ‰æµ‹è¯•

```bash
cd frontend

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# ä»¥ç›‘å¬æ¨¡å¼è¿è¡Œï¼ˆå¼€å‘ä¸­æ¨èï¼‰
npm run test -- --watch

# è¿è¡Œç‰¹å®šæ–‡ä»¶
npm run test -- Login.integration.test.tsx

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

### æ­¥éª¤ 2ï¼šç†è§£ç¤ºä¾‹æµ‹è¯•

æ‰“å¼€æˆ‘ä¸ºä½ åˆ›å»ºçš„ `Login.integration.test.tsx`ï¼Œé€ä¸ªé˜…è¯»æ¯ä¸ª `describe` å—ã€‚

### æ­¥éª¤ 3ï¼šä¿®æ”¹å’Œå®éªŒ

```typescript
// è¯•è¯•æ”¹è¿™ä¸€è¡Œ
it("should show error when submitting empty form", async () => {
  // æ”¹æˆè¿™æ ·çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ
  it("should show error when submitting form with only username", async () => {
    // ...
  });
});
```

### æ­¥éª¤ 4ï¼šçœ‹ç€æµ‹è¯•å¤±è´¥

```bash
npm run test

# ä¼šçœ‹åˆ°ï¼š
# âŒ FAIL src/__tests__/pages/auth/Login.integration.test.tsx
#    should show error when submitting form with only username
```

è¿™å¾ˆæ­£å¸¸ï¼è¿™æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰çš„è¿‡ç¨‹ã€‚

### æ­¥éª¤ 5ï¼šæ ¹æ®æµ‹è¯•ä¿®æ”¹ä»£ç 

ä¿®æ”¹ `Login.tsx` ä½¿æµ‹è¯•é€šè¿‡ã€‚

---

## ğŸ’¡ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆç”¨ userEvent è€Œä¸æ˜¯ fireEventï¼Ÿ

**A:**

```typescript
// âŒ fireEvent - è¿‡äºåº•å±‚
fireEvent.change(input, { target: { value: "hello" } });

// âœ… userEvent - æ›´æ¥è¿‘çœŸå®
const user = userEvent.setup();
await user.type(input, "hello");
```

userEvent ä¼šè§¦å‘å®Œæ•´çš„äº‹ä»¶é“¾ï¼ˆfocusã€inputã€changeã€blurï¼‰ï¼Œæ›´çœŸå®ã€‚

### Q: ä¸ºä»€ä¹ˆç”¨ screen è€Œä¸æ˜¯ getByTestIdï¼Ÿ

**A:** æŒ‰ä¼˜å…ˆçº§ï¼š

```
1ï¸âƒ£ getByRoleï¼ˆæœ€å¥½ - æ— éšœç¢ä¼˜å…ˆï¼‰
2ï¸âƒ£ getByLabelTextï¼ˆæ¬¡å¥½ï¼‰
3ï¸âƒ£ getByPlaceholderText
4ï¸âƒ£ getByText
5ï¸âƒ£ getByTestIdï¼ˆæœ€åæ‰ç”¨ - æµ‹è¯•å®ç°ç»†èŠ‚ï¼‰
```

### Q: æµ‹è¯•åº”è¯¥å†™åœ¨å“ªé‡Œï¼Ÿ

**A:** é¡¹ç›®çº¦å®šï¼š

```
src/
  __tests__/
    pages/
      auth/
        Login.integration.test.tsx  â† é›†æˆæµ‹è¯•
        Register.integration.test.tsx
    components/
      Button.unit.test.tsx          â† å•å…ƒæµ‹è¯•
    hooks/
      useAuth.test.tsx              â† Hook æµ‹è¯•
  pages/
    auth/
      Login.tsx
```

---

## ğŸ“š èµ„æºæ¨è

- [React Testing Library å®˜æ–¹æ–‡æ¡£](https://testing-library.com/docs/react-testing-library/intro/)
- [Vitest å®˜æ–¹æ–‡æ¡£](https://vitest.dev/)
- [Testing JavaScript æ•™ç¨‹](https://testingjavascript.com/)

---

**ä¸‹ä¸€æ­¥**ï¼šè¿è¡Œ `npm run test`ï¼Œçœ‹çœ‹æˆ‘ä¸ºä½ åˆ›å»ºçš„æµ‹è¯•ç”¨ä¾‹å§ï¼ ğŸš€
